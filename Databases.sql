CREATE DATABASE ORG;
 SHOW DATABASES;
CREATE TABLE Worker(
 WORKER_ID INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
 FIRST_NAME CHAR(25),
 LAST_NAME CHAR(25),
 SALARY INT(15),
 JOINING_DATE DATETIME,
 DEPERTMENT CHAR(25)
 );
 INSERT INTO Worker
 (WORKER_ID, FIRST_NAME, LAST_NAME, SALARY, JOINING_DATE, DEPERTMENT) VALUES
 (001,'Monika','Arora', 10000, '14-02-20 09.00.00', 'HR'),
 (002,'Rahul','Ghosh', 10000, '14-02-20 09.00.00', 'Admin'),
 (003,'Vishal','Verma', 90000, '15-02-20 09.00.00', 'Admin'),
 (004,'Anwesha','Mandal', 10000, '14-02-20 09.00.00', 'HR'),
 (005,'Sayan','Ghosh', 80000, '18-02-20 09.00.00', 'Account'),
 (006,'Vipul','Arora', 90000, '14-02-20 09.00.00', 'HR'),
 (007,'Monalisa','Kumari', 110000, '13-02-20 09.00.00', 'Admin'),
 (008,'Dipanshu','Ghosh', 10000, '08-02-20 09.00.00', 'Account');
 
CREATE TABLE Bonus (
WORKER_REF_ID INT,
BONUS_AMOUNT INT(10),
BONUS_DATE DATETIME,
FOREIGN KEY (WORKER_REF_ID)
	REFERENCES Worker(WORKER_ID)
    ON DELETE CASCADE
);

INSERT INTO Bonus
(WORKER_REF_ID, BONUS_AMOUNT, BONUS_DATE) VALUES
(001, 5000, '2020-03-14 10:00:00'),
(002, 3000, '2020-04-14 11:00:00'),
(003, 4000, '2020-05-14 12:00:00'),
(001, 4900, '2020-03-14 10:00:00'),
(002, 4300, '2020-04-14 11:00:00');



CREATE TABLE Title(
WORKER_REF_ID INT,
WORKER_TITLE CHAR(25),
AFFECTED_FROM DATETIME,
FOREIGN KEY (WORKER_REF_ID)
	REFERENCES Worker(WORKER_ID)
    ON DELETE CASCADE
);

INSERT INTO Title 
(WORKER_REF_ID, WORKER_TITLE, AFFECTED_FROM) VALUES
(001, 'Manager', '2016-02-20 00.00.00'),
(002, 'Executive', '2016-02-20 00.00.00'),
(008, 'Executive', '2016-02-20 00.00.00'),
(005, 'Manager', '2016-02-20 00.00.00'),
(004, 'Asst.Manager', '2016-02-20 00.00.00'),
(007, 'Executive', '2016-02-20 00.00.00'),
(006, 'Lead', '2016-02-20 00.00.00'),
(003, 'Lead', '2016-02-20 00.00.00');

SELECT FIRST_NAME,SALARY FROM Worker;
SELECT 55+23;
SELECT NOW();
SELECT * FROM Worker;
SELECT * FROM Worker WHERE SALARY<80000;
SELECT * FROM Worker WHERE DEPERTMENT = 'HR';

SELECT * FROM Worker WHERE SALARY BETWEEN 80000 AND 300000;

-- REDUCE OR STATEMENTS
SELECT * FROM Worker WHERE DEPERTMENT= 'HR'OR DEPERTMENT = 'ADMIN';

-- BETTER WAY : IN
SELECT * FROM Worker WHERE DEPERTMENT IN ('HR','ADMIN');

SELECT * FROM Worker WHERE DEPERTMENT NOT IN ('HR','ADMIN');

SELECT * FROM Worker WHERE DEPERTMENT IN ('HR','ADMIN');

USE ORG;
SELECT * FROM Worker WHERE DEPERTMENT NOT IN ('HR','ADMIN');


-- WILD CARD
SELECT * FROM Worker WHERE FIRST_NAME LIKE '%I%';
SELECT * FROM Worker WHERE  FIRST_NAME LIKE '%MO%'; 
SELECT * FROM Worker WHERE FIRST_NAME LIKE '_I%';
SELECT * FROM Worker WHERE FIRST_NAME LIKE '___I%';

-- SORTING USING ORDER BY
SELECT * FROM Worker ORDER BY SALARY;
SELECT * FROM Worker ORDER BY SALARY DESC; -- FOR DECENDING ORDER


-- DISTINCT KEYWORD
SELECT DISTINCT DEPERTMENT FROM WORKER;


-- DATA GROUPING APPLY AGGRIGATION
   -- FIND NO OF EMPLOYEES WORKING IN DIFFERENT DEPARTMENT?
SELECT DEPERTMENT , COUNT(DEPERTMENT) FROM WORKER GROUP BY DEPERTMENT;

-- FIND AVG SALARY PER DEPARTMENT
SELECT DEPERTMENT , AVG(SALARY)  FROM WORKER GROUP BY DEPERTMENT;
-- MIN
SELECT DEPERTMENT , MIN(SALARY)  FROM WORKER GROUP BY DEPERTMENT;

-- MAX
SELECT DEPERTMENT , MAX(SALARY)  FROM WORKER GROUP BY DEPERTMENT;

-- SUM / TOTAL
SELECT DEPERTMENT , SUM(SALARY)  FROM WORKER GROUP BY DEPERTMENT;

-- GROUP BT HAVING
    -- FIND DEPERTMENT ,COUNT , HAVING MORE THAN 2 WORKERS?
 SELECT DEPERTMENT , COUNT(DEPERTMENT) FROM WORKER GROUP BY DEPERTMENT HAVING COUNT(DEPERTMENT) > 2;

USE ORG;

